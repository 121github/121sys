<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">

<head profile="http://gmpg.org/xfn/11">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title> Leo Horsfield Surveying</title>
    <link rel="stylesheet" href="style.css" type="text/css" media="screen"/>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
</head>

<body>
<div id="topTab"></div>
<!-- Start container -->
<div id="container">
    <h1 class="special">Leo Horsfield Surveying</h1>
    <img
        src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/LeoHorsfieldSurveying_logo.gif"
        alt="Leo Horsfield Surveying" title="Leo Horsfield Surveying" class="floatLeft"/>
    <img src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/strapLine.jpg"
         alt="Building Surveyors & Engineers" title="Building Surveyors & Engineers" class="strapline"/>
    <div id="navContainer" class="menu-main-menu-container">
        <ul id="navList" class="menu">
            <li id="menu-item-1310"
                class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-5 current_page_item menu-item-1310">
                <a href="http://www.leohorsfieldsurveying.co.uk/">Home</a></li>
            <li id="menu-item-24" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a
                    href="http://www.leohorsfieldsurveying.co.uk/about">About</a></li>
            <li id="menu-item-22" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22"><a
                    href="http://www.leohorsfieldsurveying.co.uk/services">Services</a></li>
            <li id="menu-item-27" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-27"><a
                    href="http://www.leohorsfieldsurveying.co.uk/portfolio">Portfolio</a></li>
            <li id="menu-item-21" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-21"><a
                    href="http://www.leohorsfieldsurveying.co.uk/news">News</a></li>
            <li id="menu-item-782" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-782"><a
                    href="http://www.leohorsfieldsurveying.co.uk/testimonials">Testimonials</a></li>
            <li id="menu-item-20" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-20"><a
                    href="http://www.leohorsfieldsurveying.co.uk/contact">Contact</a></li>
            <li id="menu-item-19" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-19"><a
                    href="http://www.leohorsfieldsurveying.co.uk/links">Links</a></li>
            <li id="menu-item-1258" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1258"><a
                    href="http://www.leohorsfieldsurveying.co.uk/blog">Blog</a></li>
        </ul>
    </div>
    <div id="followMe" class="floatLeft">Follow us: <a href="#"><img
                src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/facebook.jpg"
                width="16" height="16" alt="Facebook"/></a> <a href="#"><img
                src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/twitter.jpg"
                width="16" height="16" alt="Twitter"/></a> <a href="#"><img
                src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/linkedin.jpg"
                width="16" height="16" alt="LinkedIn"/></a></div>
    <div style="clear:both; padding:20px"><h3>Please enter the details below to arrange a survey</h3>
        <form method="post" class="lhs-form" id="lhs-form">
            <style>
                input[type=text] {
                    background: #e9e9e9 none repeat scroll 0 0;
                    border: 1px solid #e9e9e9;
                    padding-top: 3px;
                    padding-bottom: 3px;
                    padding-left: 3px;
                    width: 100%
                }

                td {
                    padding: 5px;
                }

                select {
                    height: 25px;
                    width: 100%;
                    background: #e9e9e9;
                }

                td.label {
                    padding: 0
                }

                .checkbox {
                    float: right
                }

                textarea {
                    Helvetica, Arial, sans-serif
                }
            </style>
            <table>
                <tr>
                    <td colspan="3" class="label">Name</td>
                </tr>
                <tr>
                    <td>
                        <select name="title">
                            <option value="Mr">Mr</option>
                            <option value="Mrs">Mrs</option>
                            <option value="Miss">Miss</option>
                        </select></td>
                    <td><input type="text" name="firstname" placeholder="Enter Firstname" required></td>
                    <td><input type="text" value="" name="lastname" placeholder="Enter Lastname" required></td>
                </tr>
                <tr>
                    <td colspan="3" class="label">Survey Address</td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="text" id="survey-address" name="survey_address" placeholder="Enter the survey address" required>
                    </td>
                    <td colspan="1">
                        <input type="text" id="survey-address-postcode" name="survey_address_postcode" placeholder="Enter the postcode" required>
                    </td>
                </tr>
                <tr>
                    <td colspan="3" class="label">Corresponence Address <span class="checkbox"><input type="checkbox"/> Use above</span>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="text" id="address" name="correspondence_address"placeholder="Enter the correspondence address">
                    </td>
                    <td colspan="1">
                        <input type="text" id="postcode" name="correspondence_address_postcode" placeholder="Enter the postcode">
                    </td>
                </tr>
                <tr>
                    <td colspan="3" class="label">Access Address <span class="checkbox"><input type="checkbox"/> Use above</span>
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <input type="text" id="address" name="access_address" placeholder="Enter the access address">
                    </td>
                    <td colspan="1">
                        <input type="text" id="postcode" name="access_address_postcode" placeholder="Enter the postcode">
                    </td>
                </tr>
                <tr>
                    <td colspan="3" class="label">Telephone number</td>
                </tr>
                <tr>
                    <td colspan="3"><input type="text" name="telephone_number" placeholder="Enter the telephone number">
                    </td>
                </tr>
                <tr>
                    <td colspan="3" class="label">Email Address</td>
                </tr>
                <tr>
                    <td colspan="3"><input type="text" name="email_address" placeholder="Enter the email address"></td>
                </tr>

                <tr>
                    <td colspan="3" class="label">Survey Type</td>
                </tr>
                <tr>
                    <td colspan="3"><select name="survey_type" required>
                            <option value="">--Type of survey--</option>
                            <option value="Building Survey">Building Survey</option>
                            <option value="Home Buyer Report">Home Buyer Report</option>
                            <option value="General Structural Inspection">General Structural Inspection</option>
                            <option value="Specific Inspection">Specific Inspection</option>
                            <option value="Valuation">Valuation</option>
                            <option value="Party Wall">Party Wall</option>
                            <option value="Structural Calculations">Structural Calculations</option>
                            <option value="Expert Witness">Expert Witness</option>
                            <option value="Other">Other</option>
                        </select></td>
                </tr>

                <tr>
                    <td colspan="3" class="label">Additional Info</td>
                </tr>
                <tr>
                    <td colspan="3"><textarea name="additional_info" placeholder="Enter any additional info"></textarea>
                    </td>
                </tr>
                <tr>
                    <td colspan="3">
                        <button type="submit">Send</button>
                    </td>
                </tr>
            </table>
        </form>
        <script>
            $(document).ready(function () {
                $('.checkbox input').change(function () {
                    if ($(this).prop('checked')) {
                        var address = $('#survey-address').val();
                        var postcode = $('#survey-address-postcode').val();
                    } else {
                        var address = "";
                        var postcode = "";
                    }
                    $(this).closest('tr').next().find('input[id="address"]').val(address);
                    $(this).closest('tr').next().find('input[id="postcode"]').val(postcode);
                });
            });

            $('.lhs-form').on('submit', function (e) {
                e.preventDefault();

                var baseUrl = document.location.origin + '/';
                //Create record
                $.ajax({
                    url: baseUrl + 'api/record',
                    beforeSend: function(xhr) {
                        xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                    },
                    type: "POST",
                    dataType: "JSON",
                    data: {
                        "campaign_id": "7",
                        "record_status": "1",
                        "source_id": "1",
                        "pot_id": "0",
                    }
                }).done(function (response) {
                    if (response.success) {
                          //Insert record_details
                        var survey_type = $('.lhs-form').find('select[name="survey_type"]').val();
                        var additional_info = $('.lhs-form').find('textarea[name="additional_info"]').val();
                        $.ajax({
                            url: baseUrl + 'api/record_details',
                            beforeSend: function(xhr) {
                                xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                            },
                            type: "POST",
                            dataType: "JSON",
                            data: {
                                "urn": response.urn,
                                "c3": survey_type,
                                "c4": additional_info
                            }
                        }).done(function (response) {
                            if (response.success) {
                                //Insert record contact
                                var title = $('.lhs-form').find('select[name="title"]').val();
                                var firstname = $('.lhs-form').find('input[name="firstname"]').val();
                                var lastname = $('.lhs-form').find('input[name="lastname"]').val();
                                var survey_address = $('.lhs-form').find('input[name="survey_address"]').val();
                                var survey_address_postcode = $('.lhs-form').find('input[name="survey_address_postcode"]').val();
                                var correspondence_address = $('.lhs-form').find('input[name="correspondence_address"]').val();
                                var correspondence_address_postcode = $('.lhs-form').find('input[name="correspondence_address_postcode"]').val();
                                var access_address = $('.lhs-form').find('input[name="access_address"]').val();
                                var access_address_postcode = $('.lhs-form').find('input[name="access_address_postcode"]').val();
                                var telephone_number = $('.lhs-form').find('input[name="telephone_number"]').val();
                                var email_address = $('.lhs-form').find('input[name="email_address"]').val();

                                $.ajax({
                                    url: baseUrl + 'api/record_contact',
                                    beforeSend: function(xhr) {
                                        xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                    },
                                    type: "POST",
                                    dataType: "JSON",
                                    data: {
                                        "urn": response.urn,
                                        "title": title,
                                        "firstname": firstname,
                                        "lastname": lastname,
                                        "fullname": title+" "+firstname+" "+lastname,
                                        "email": email_address
                                    }
                                }).done(function (response) {
                                    //Insert addresses
                                    if (survey_address != '') {
                                        $.ajax({
                                            url: baseUrl + 'api/contact_address',
                                            beforeSend: function(xhr) {
                                                xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                            },
                                            type: "POST",
                                            dataType: "JSON",
                                            data: {
                                                "contact_id": response.contact_id,
                                                "add1": survey_address,
                                                "postcode": survey_address_postcode,
                                                "description": "Survey Address"
                                            }
                                        });
                                    }
                                    if (correspondence_address != '') {
                                        $.ajax({
                                            url: baseUrl + 'api/contact_address',
                                            beforeSend: function(xhr) {
                                                xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                            },
                                            type: "POST",
                                            dataType: "JSON",
                                            data: {
                                                "contact_id": response.contact_id,
                                                "add1": correspondence_address,
                                                "postcode": correspondence_address_postcode,
                                                "description": "Correspondence Address"
                                            }
                                        });
                                    }
                                    if (access_address != '') {
                                        $.ajax({
                                            url: baseUrl + 'api/contact_address',
                                            beforeSend: function(xhr) {
                                                xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                            },
                                            type: "POST",
                                            dataType: "JSON",
                                            data: {
                                                "contact_id": response.contact_id,
                                                "add1": access_address,
                                                "postcode": access_address_postcode,
                                                "description": "Access Detail Address"
                                            }
                                        });
                                    }

                                    //Insert contact telephone
                                    $.ajax({
                                        url: baseUrl + 'api/contact_telephone',
                                        beforeSend: function(xhr) {
                                            xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                        },
                                        type: "POST",
                                        dataType: "JSON",
                                        data: {
                                            "contact_id": response.contact_id,
                                            "telephone_number": telephone_number,
                                        }
                                    });

                                    //Send confirmation Email
                                    $.ajax({
                                        url: baseUrl + 'api/send_email',
                                        beforeSend: function(xhr) {
                                            xhr.setRequestHeader("Authorization", "Basic " + btoa("admin:382ae706f2"));
                                        },
                                        type: "POST",
                                        dataType: "JSON",
                                        data: {
                                            'urn': response.urn,
                                            'template_id': 1,
                                            'recipients_to': '',
                                            'recipients_to_name': '',
                                            'recipients_cc': '',
                                            'recipients_bcc': ''
                                        }
                                    });

                                    alert("Record created! URN: "+response.urn);

                                    //Reset form
                                    document.getElementById("lhs-form").reset();
                                });
                            }
                        });
                    }
                });
            });
        </script>

    </div>

    <div id="footer" style="margin-top:5px;">

        <p class="floatLeft">e: <a href="mailto:info@lhsurveying.co.uk">info@lhsurveying.co.uk</a> | &copy; Leo
            Horsfield Surveying Ltd 2016 | <span style="font-size:11px;">Website by <a href="http://www.tbgd.co.uk"
                                                                                       target="_blank" class="footer">tbgd</a></span>
        </p>
        <a href="http://www.rics.org/" target="_blank"><img
                src="http://www.leohorsfieldsurveying.co.uk/wp-content/themes/WP%20by%20tbgd/style/images/accreds.jpg"
                alt="Accreditations" border="0" usemap="#Map2" class="floatRight"/>
            <map name="Map2" id="Map2">
                <area shape="rect" coords="1,2,88,39" href="http://www.rics.org/" alt="Link to RICS" target="_blank"/>
                <area shape="rect" coords="93,3,140,36" href="http://www.constructionline.co.uk/static/"
                      alt="Link to Constructionline" target="_blank"/>
                <area shape="rect" coords="148,2,194,36" href="http://www.abe.org.uk/"
                      alt="Link to The Association of Building Engineers" target="_blank"/>
                <area shape="rect" coords="203,2,250,35" href="https://www.aps.org.uk/"
                      alt="Link to Association for Project Safety" target="_blank"/>
                <area shape="rect" coords="258,4,380,37" href="http://www.cbcschemes.org.uk/"
                      alt="Link to Chartered Building Consultancy" target="_blank"/>
            </map>
        </a>
        <div class="clear"><span class="ietrick">&nbsp;</span></div>
    </div>
</div>

</body>

</html>